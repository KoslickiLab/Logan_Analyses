LABELING CLARIFICATION - FracMinHash Parameters
================================================

Issue Raised:
-------------
The hash counts are based on FracMinHash sketches with:
- k-mer size: 31
- scale factor: 1000 (sampling 1/1000 of k-mers)

Should the axis labels say "per kilobase" or "per gigabase" instead of "per megabase"?

Analysis:
---------
With k=31 and scale=1000:
- 1 megabase contains ~1,000,000 31-mers
- FracMinHash samples 1/1000 of those
- Expected sampled hashes per megabase: ~1,000 (if all k-mers unique)

Scale Comparison:
- Per kilobase: Values would be ~0.1-2.0 (too small, hard to interpret)
- Per megabase: Values are ~100-2000 (good range, interpretable)
- Per gigabase: Values would be millions (too large)

Decision:
---------
Keep "per megabase" but ADD CONTEXT about FracMinHash parameters.

Changes Made:
-------------

1. Main Plot X-axis:
   Before: "Distinct hashes per megabase"
   After:  "k-mer hash density per megabase\n(31-mer FracMinHash, scale=1000)"

2. Main Plot Title:
   Before: "Correlation between Hash Density and Alpha Diversity"
   After:  "Correlation between k-mer Hash Density and Alpha Diversity"

3. Hexbin Plot:
   Updated to match main plot labels with FracMinHash parameters

4. Distribution Plots:
   - "k-mer hash density per Mb\n(31-mer, scale=1000)"
   - "Total distinct k-mer hashes\n(31-mer, scale=1000)"

5. Sensitivity Analysis Plots:
   Updated Y-axis labels to include FracMinHash parameters

6. Report Header:
   Added line: "FracMinHash Parameters: k=31, scale=1000"

7. Report Normalized Metrics Section:
   - Changed "Hashes per Mb" to "k-mer hash density per Mb (31-mer, scale=1000)"
   - Added note: "Scale=1000 means ~1/1000 of k-mers are sampled"

8. Script Docstring:
   Added explanation: "This script analyzes FracMinHash sketches (k=31, scale=1000) 
   generated by the YACHT algorithm. The hash counts represent approximately 1/1000 
   of the 31-mers present in each sample."

Interpretation:
---------------
The "k-mer hash density per megabase" now clearly indicates:

1. These are k-mer hashes (not raw sequence features)
2. They come from 31-mers specifically
3. They represent a FracMinHash sketch with scale=1000
4. The density is normalized by megabases

For a typical sample:
- 1 Mb of sequence → ~1M 31-mers → ~1000 sampled hashes (if unique)
- Hash density of 500/Mb = relatively low complexity
- Hash density of 2000/Mb = relatively high complexity

The scale factor (1/1000 sampling) is now explicit in the labels, making it clear
to readers that these values represent sampled k-mers, not all k-mers.

Publication Impact:
-------------------
These labels are now suitable for publication because they:
1. Specify the exact k-mer size (31)
2. Identify the sketch type (FracMinHash)
3. Include the scale parameter (1000)
4. Use standard units (megabase)

Reviewers will be able to understand exactly what metric is being plotted without
needing to read the methods section first.

Example Interpretation:
-----------------------
A correlation of r=0.7 between "k-mer hash density per Mb (31-mer FracMinHash, 
scale=1000)" and "alpha diversity per Mb" means:

"Samples with more diverse k-mer composition (as measured by FracMinHash sketches 
with k=31 and scale=1000) tend to have higher taxonomic diversity when both metrics 
are normalized by sequencing depth."

The scale factor being explicit makes it clear that this is a sketch-based approximation,
not exhaustive k-mer counting.
